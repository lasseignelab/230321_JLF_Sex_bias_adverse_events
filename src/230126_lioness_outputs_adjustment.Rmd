---
title: "230126_lioness_outputs_adjustment"
author: "Jennifer Fisher"
date: "2023-01-26"
output:
  html_document:
    toc: true
    theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# START 
    Goal/Purpose of operations: 
    I need to convert the data format of the lioness outputs from array jobs to edges by sample dataframes for limma differential edges analysis 
    
    Finished psedocode on:
    230127
    
    System which operations were done on: 
    Cheaha
    
    GitHub Repo:
    Sex_Bias_Adverse_Events
    
    Docker/Singularity: 
    rstudio_sex_bias_drugs
    
    Directory of operations: 
    "/data/project/lasseigne_lab/JLF_scratch/Sex_Bias_Adverse_Events"
    
    Scripts being edited for operations:
    created a new function xx in the sex_bias_functions.R for the data wrangling 
    
    Data being used: 
    the proccessed gene expression from the ./output/proccessed_normalized_expression and meta data from the 210806_GTEx_Age_Sex.Rmd script
    
    Papers and tools:
    panda and alpaca from the netzzor package

# STEPS
### Set working directory 
```{r}
#change this path to match your paths 
dir_path <- "/data/project/lasseigne_lab/JLF_scratch/Sex_Bias_Adverse_Events/"
```


```{r}
source(paste0(dir_path, "script/sex_bias_drug_functions.R"))
library(tidyverse)
```


### load in data

```{r}
metadata <- readRDS(paste0(dir_path, "data/metadata_gtex_filter_samples.rds"))

tissues <- unique(metadata$gtex.smtsd)
#remove cell tissues
tissues<- tissues[! grepl("Cell", tissues)]
```
note processed data had the white sapce removed 
```{r}
tissues_wo_ws <- gsub(" ", "_", tissues, fixed = TRUE)
```

```{r}
lioness_output_files <- list.files(paste0(dir_path, "output/lioness/lioness_jobs_output/"))
```



### Analysis

```{r}
for (k in 1:length(tissues_wo_ws)){
  print(tissues_wo_ws[k])
  lioness_output_adjustment(k)
}

```



### Save Data
Done in script
    
# END
    Location of final scripts:
    scripts
  
    
    Location of data produced:
    /data/project/lasseigne_lab/JLF_scratch/Sex_Bias_Adverse_Events/output/lioness/adjusted_lioness_outputs
    
    Dates when operations were done:
    230127
    
## Versions
```{r}
sessionInfo()
```


